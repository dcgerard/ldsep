<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate all pair-wise LD's in a collection of SNPs using genotypes or genotype likelihoods. — mldest • ldsep</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate all pair-wise LD's in a collection of SNPs using genotypes or genotype likelihoods. — mldest"><meta name="description" content="This function is a wrapper to run ldest() for many pairs of
SNPs. This takes a maximum likelihood approach to LD estimation. See
ldfast() for a method-of-moments approach to LD estimation.
Support is provided for parallelization through the foreach and doParallel
packages. See Gerard (2021) for details."><meta property="og:description" content="This function is a wrapper to run ldest() for many pairs of
SNPs. This takes a maximum likelihood approach to LD estimation. See
ldfast() for a method-of-moments approach to LD estimation.
Support is provided for parallelization through the foreach and doParallel
packages. See Gerard (2021) for details."><meta property="og:image" content="https://dcgerard.github.io/ldsep/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ldsep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/fast.html">Fast LD Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/vcf.html">LD Estimation Pipeline from VCF</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dcgerard/ldsep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate all pair-wise LD's in a collection of SNPs using genotypes or genotype likelihoods.</h1>
      <small class="dont-index">Source: <a href="https://github.com/dcgerard/ldsep/blob/HEAD/R/multild.R" class="external-link"><code>R/multild.R</code></a></small>
      <div class="d-none name"><code>mldest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is a wrapper to run <code><a href="ldest.html">ldest</a>()</code> for many pairs of
SNPs. This takes a maximum likelihood approach to LD estimation. See
<code><a href="ldfast.html">ldfast</a>()</code> for a method-of-moments approach to LD estimation.
Support is provided for parallelization through the foreach and doParallel
packages. See Gerard (2021) for details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mldest</span><span class="op">(</span></span>
<span>  <span class="va">geno</span>,</span>
<span>  <span class="va">K</span>,</span>
<span>  nc <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hap"</span>, <span class="st">"comp"</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"flex"</span><span class="op">)</span>,</span>
<span>  pen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"hap"</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-geno">geno<a class="anchor" aria-label="anchor" href="#arg-geno"></a></dt>
<dd><p>One of two possible inputs:</p><ul><li><p>A matrix of genotypes (allele dosages). The rows index the
SNPs and the columns index the individuals. That is,
<code>genomat[i, j]</code> is the allele dosage for individual
<code>j</code> in SNP <code>i</code>. When <code>type = "comp"</code>, the
dosages are allowed to be continuous (e.g. posterior
mean genotypes).</p></li>
<li><p>A three-way array of genotype <em>log</em>-likelihoods.
The first dimension indexes the SNPs, the second dimension
indexes the individuals, and the third dimension indexes
the genotypes. That is, <code>genolike_array[i, j, k]</code>
is the genotype log-likelihood at SNP <code>i</code> for
individual <code>j</code> and dosage <code>k - 1</code>.</p></li>
</ul></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>The ploidy of the species. Assumed to be the same for all
individuals.</p></dd>


<dt id="arg-nc">nc<a class="anchor" aria-label="anchor" href="#arg-nc"></a></dt>
<dd><p>The number of computing cores to use. This should never be
more than the number of cores available in your computing environment.
You can determine the maximum number of available cores by running
<code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code> in R. This is probably fine for a
personal computer, but some environments are only
able to use fewer. Ask your admins if you are unsure.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The type of LD to calculate. The available types are
haplotypic LD (<code>type = "hap"</code>) or composite LD
(<code>type = "comp"</code>). Haplotypic LD is only appropriate for
autopolyploids when the individuals are in Hardy-Weinberg
equilibrium (HWE). The composite
measures of LD are always applicable, and consistently estimate the
usual measures of LD when HWE is fulfilled in autopolyploids.
However, when HWE is not fulfilled, interpreting the
composite measures of LD could be a little tricky.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>When <code>type = "comp"</code> and using genotype likelihoods,
should we use the proportional
bivariate normal model to estimate the genotype distribution
(<code>model = "norm"</code>), or the general categorical distribution
(<code>model = "flex"</code>)? Defaults to <code>"norm"</code>.</p></dd>


<dt id="arg-pen">pen<a class="anchor" aria-label="anchor" href="#arg-pen"></a></dt>
<dd><p>The penalty to be applied to the likelihood. You can think about
this as the prior sample size. Should be greater than 1. Does not
apply if <code>model = "norm"</code>, <code>type = "comp"</code>, and using
genotype likelihoods. Also does not apply when <code>type = "comp"</code>
and using genotypes.</p></dd>


<dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>A logical. Should we calculate standard errors (<code>TRUE</code>) or
not (<code>FALSE</code>). Calculating standard errors can be really slow
when <code>type = "comp"</code>, <code>model = "flex"</code>, and when using
genotype likelihoods. Otherwise, standard error calculations
should be pretty fast.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame of class <code>c("lddf", "data.frame")</code>
with some or all of the following elements:</p><dl><dt><code>i</code></dt>
<dd><p>The index of the first SNP.</p></dd>

<dt><code>j</code></dt>
<dd><p>The index of the second SNP.</p></dd>

<dt><code>snpi</code></dt>
<dd><p>The row name corresponding to SNP <code>i</code>, if
row names are provided.</p></dd>

<dt><code>snpj</code></dt>
<dd><p>The row name corresponding to SNP <code>j</code>, if
row names are provided.</p></dd>

<dt><code>D</code></dt>
<dd><p>The estimate of the LD coefficient.</p></dd>

<dt><code>D_se</code></dt>
<dd><p>The standard error of the estimate of
the LD coefficient.</p></dd>

<dt><code>r2</code></dt>
<dd><p>The estimate of the squared Pearson correlation.</p></dd>

<dt><code>r2_se</code></dt>
<dd><p>The standard error of the estimate of the
squared Pearson correlation.</p></dd>

<dt><code>r</code></dt>
<dd><p>The estimate of the Pearson correlation.</p></dd>

<dt><code>r_se</code></dt>
<dd><p>The standard error of the estimate of the
Pearson correlation.</p></dd>

<dt><code>Dprime</code></dt>
<dd><p>The estimate of the standardized LD
coefficient. When <code>type</code> = "comp", this corresponds
to the standardization where we fix allele frequencies.</p></dd>

<dt><code>Dprime_se</code></dt>
<dd><p>The standard error of <code>Dprime</code>.</p></dd>

<dt><code>Dprimeg</code></dt>
<dd><p>The estimate of the standardized LD
coefficient. This corresponds to the standardization where
we fix genotype frequencies.</p></dd>

<dt><code>Dprimeg_se</code></dt>
<dd><p>The standard error of <code>Dprimeg</code>.</p></dd>

<dt><code>z</code></dt>
<dd><p>The Fisher-z transformation of <code>r</code>.</p></dd>

<dt><code>z_se</code></dt>
<dd><p>The standard error of the Fisher-z
transformation of <code>r</code>.</p></dd>

<dt><code>p_ab</code></dt>
<dd><p>The estimated haplotype frequency of ab.
Only returned if estimating the haplotypic LD.</p></dd>

<dt><code>p_Ab</code></dt>
<dd><p>The estimated haplotype frequency of Ab.
Only returned if estimating the haplotypic LD.</p></dd>

<dt><code>p_aB</code></dt>
<dd><p>The estimated haplotype frequency of aB.
Only returned if estimating the haplotypic LD.</p></dd>

<dt><code>p_AB</code></dt>
<dd><p>The estimated haplotype frequency of AB.
Only returned if estimating the haplotypic LD.</p></dd>

<dt><code>q_ij</code></dt>
<dd><p>The estimated frequency of genotype i at locus 1
and genotype j at locus 2. Only returned if estimating the
composite LD.</p></dd>

<dt><code>n</code></dt>
<dd><p>The number of individuals used to estimate pairwise LD.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See <code><a href="ldest.html">ldest</a>()</code> for details on the different types of LD
estimators supported.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Gerard, David. "Pairwise Linkage Disequilibrium Estimation
for Polyploids." <em>Molecular Ecology Resources</em> 21,
no. 4 (2021): 1230-1242. <a href="https://doi.org/10.1111/1755-0998.13349" class="external-link">doi:10.1111/1755-0998.13349</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<dl><dt><code><a href="ldfast.html">ldfast</a>()</code></dt>
<dd><p>Fast, moment-based approach to LD estimation
that also accounts for genotype uncertainty.</p></dd>

<dt><code><a href="ldest.html">ldest</a>()</code></dt>
<dd><p>For the base function that estimates
pairwise LD.</p></dd>

<dt><code><a href="sldest.html">sldest</a>()</code></dt>
<dd><p>For estimating pairwise LD along a
sliding window.</p></dd>

<dt><code><a href="format_lddf.html">format_lddf</a>()</code></dt>
<dd><p>For formatting the output of
<code>mldest()</code> as a matrix.</p></dd>

<dt><code><a href="plot.lddf.html">plot.lddf</a>()</code></dt>
<dd><p>For plotting the output of
<code>mldest()</code>.</p></dd>


</dl></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Gerard</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate genotypes when true correlation is 0</span></span></span>
<span class="r-in"><span><span class="va">nloci</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">nind</span>  <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">6</span></span></span>
<span class="r-in"><span><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">genomat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">K</span>, <span class="va">nind</span> <span class="op">*</span> <span class="va">nloci</span>, <span class="cn">TRUE</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nloci</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Composite LD estimates</span></span></span>
<span class="r-in"><span><span class="va">lddf</span> <span class="op">&lt;-</span> <span class="fu">mldest</span><span class="op">(</span>geno <span class="op">=</span> <span class="va">genomat</span>,</span></span>
<span class="r-in"><span>               K <span class="op">=</span> <span class="va">K</span>,</span></span>
<span class="r-in"><span>               nc <span class="op">=</span> <span class="va">nc</span>,</span></span>
<span class="r-in"><span>               type <span class="op">=</span> <span class="st">"comp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lddf</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   i j snpi snpj           D       D_se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 2   NA   NA -0.05574074 0.06524343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1 3   NA   NA  0.04799663 0.07253549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1 4   NA   NA -0.01888889 0.07108531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1 5   NA   NA -0.08323232 0.06259828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2 3   NA   NA  0.01718855 0.06978495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2 4   NA   NA  0.03599327 0.06858949</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Gerard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

