<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sliding window LD estimation — sldest • ldsep</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sliding window LD estimation — sldest" />
<meta property="og:description" content="This function is a wrapper for ldest() for estimating LD
along a sliding window of a fixed size. Support is provided for parallelization through the
foreach and doParallel packages." />
<meta property="og:image" content="https://dcgerard.github.io/ldsep/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ldsep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fast.html">Fast LD Estimation</a>
    </li>
    <li>
      <a href="../articles/vcf.html">LD Estimation Pipeline from VCF</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dcgerard/ldsep/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sliding window LD estimation</h1>
    <small class="dont-index">Source: <a href='https://github.com/dcgerard/ldsep/blob/master/R/sliding_window.R'><code>R/sliding_window.R</code></a></small>
    <div class="hidden name"><code>sldest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is a wrapper for <code><a href='ldest.html'>ldest</a>()</code> for estimating LD
along a sliding window of a fixed size. Support is provided for parallelization through the
foreach and doParallel packages.</p>
    </div>

    <pre class="usage"><span class='fu'>sldest</span><span class='op'>(</span>
  <span class='va'>geno</span>,
  <span class='va'>K</span>,
  win <span class='op'>=</span> <span class='fl'>50</span>,
  nc <span class='op'>=</span> <span class='fl'>1</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"hap"</span>, <span class='st'>"comp"</span><span class='op'>)</span>,
  model <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"norm"</span>, <span class='st'>"flex"</span><span class='op'>)</span>,
  pen <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>type</span> <span class='op'>==</span> <span class='st'>"hap"</span>, <span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>)</span>,
  se <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>geno</th>
      <td><p>One of two possible inputs:</p><ul>
<li><p>A matrix of genotypes (allele dosages). The rows index the
SNPs and the columns index the individuals. That is,
<code>genomat[i, j]</code> is the allele dosage for individual
<code>j</code> in SNP <code>i</code>. When <code>type = "comp"</code>, the
dosages are allowed to be continuous (e.g. posterior
mean genotypes).</p></li>
<li><p>A three-way array of genotype <em>log</em>-likelihoods.
The first dimension indexes the SNPs, the second dimension
indexes the individuals, and the third dimension indexes
the genotypes. That is, <code>genolike_array[i, j, k]</code>
is the genotype log-likelihood at SNP <code>i</code> for
individual <code>j</code> and dosage <code>k - 1</code>.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>The ploidy of the species. Assumed to be the same for all
individuals.</p></td>
    </tr>
    <tr>
      <th>win</th>
      <td><p>The window size. Pairwise LD will be estimated plus or minus
these many positions. Larger sizes significantly increase the
computational load.</p></td>
    </tr>
    <tr>
      <th>nc</th>
      <td><p>The number of computing cores to use. This should never be
more than the number of cores available in your computing environment.
You can determine the maximum number of available cores by running
<code><a href='https://rdrr.io/r/parallel/detectCores.html'>parallel::detectCores()</a></code> in R. This is probably fine for a
personal computer, but some environments are only
able to use fewer. Ask your admins if you are unsure.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>The type of LD to calculate. The available types are
haplotypic LD (<code>type = "hap"</code>) or composite LD
(<code>type = "comp"</code>). Haplotypic LD is only appropriate for
autopolyploids when the individuals are in Hardy-Weinberg
equilibrium (HWE). The composite
measures of LD are always applicable, and consistently estimate the
usual measures of LD when HWE is fulfilled in autopolyploids.
However, when HWE is not fulfilled, interpreting the
composite measures of LD could be a little tricky.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>When <code>type = "comp"</code> and using genotype likelihoods,
should we use the proportional
bivariate normal model to estimate the genotype distribution
(<code>model = "norm"</code>), or the general categorical distribution
(<code>model = "flex"</code>)? Defaults to <code>"norm"</code>.</p></td>
    </tr>
    <tr>
      <th>pen</th>
      <td><p>The penalty to be applied to the likelihood. You can think about
this as the prior sample size. Should be greater than 1. Does not
apply if <code>model = "norm"</code>, <code>type = "comp"</code>, and using
genotype likelihoods. Also does not apply when <code>type = "comp"</code>
and using genotypes.</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>A logical. Should we calculate standard errors (<code>TRUE</code>) or
not (<code>FALSE</code>). Calculating standard errors can be really slow
when <code>type = "comp"</code>, <code>model = "flex"</code>, and when using
genotype likelihoods. Otherwise, standard error calculations
should be pretty fast.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame of class <code><a href='https://rdrr.io/r/base/c.html'>c("lddf", "data.frame")</a></code>
with some or all of the following elements:</p><dl>
<dt><code>i</code></dt><dd><p>The index of the first SNP.</p></dd>
<dt><code>j</code></dt><dd><p>The index of the second SNP.</p></dd>
<dt><code>snpi</code></dt><dd><p>The row name corresponding to SNP <code>i</code>, if
row names are provided.</p></dd>
<dt><code>snpj</code></dt><dd><p>The row name corresponding to SNP <code>j</code>, if
row names are provided.</p></dd>
<dt><code>D</code></dt><dd><p>The estimate of the LD coefficient.</p></dd>
<dt><code>D_se</code></dt><dd><p>The standard error of the estimate of
the LD coefficient.</p></dd>
<dt><code>r2</code></dt><dd><p>The estimate of the squared Pearson correlation.</p></dd>
<dt><code>r2_se</code></dt><dd><p>The standard error of the estimate of the
squared Pearson correlation.</p></dd>
<dt><code>r</code></dt><dd><p>The estimate of the Pearson correlation.</p></dd>
<dt><code>r_se</code></dt><dd><p>The standard error of the estimate of the
Pearson correlation.</p></dd>
<dt><code>Dprime</code></dt><dd><p>The estimate of the standardized LD
coefficient. When <code>type</code> = "comp", this corresponds
to the standardization where we fix allele frequencies.</p></dd>
<dt><code>Dprime_se</code></dt><dd><p>The standard error of <code>Dprime</code>.</p></dd>
<dt><code>Dprimeg</code></dt><dd><p>The estimate of the standardized LD
coefficient. This corresponds to the standardization where
we fix genotype frequencies.</p></dd>
<dt><code>Dprimeg_se</code></dt><dd><p>The standard error of <code>Dprimeg</code>.</p></dd>
<dt><code>z</code></dt><dd><p>The Fisher-z transformation of <code>r</code>.</p></dd>
<dt><code>z_se</code></dt><dd><p>The standard error of the Fisher-z
transformation of <code>r</code>.</p></dd>
<dt><code>p_ab</code></dt><dd><p>The estimated haplotype frequency of ab.
Only returned if estimating the haplotypic LD.</p></dd>
<dt><code>p_Ab</code></dt><dd><p>The estimated haplotype frequency of Ab.
Only returned if estimating the haplotypic LD.</p></dd>
<dt><code>p_aB</code></dt><dd><p>The estimated haplotype frequency of aB.
Only returned if estimating the haplotypic LD.</p></dd>
<dt><code>p_AB</code></dt><dd><p>The estimated haplotype frequency of AB.
Only returned if estimating the haplotypic LD.</p></dd>
<dt><code>q_ij</code></dt><dd><p>The estimated frequency of genotype i at locus 1
and genotype j at locus 2. Only returned if estimating the
composite LD.</p></dd>
<dt><code>n</code></dt><dd><p>The number of individuals used to estimate pairwise LD.</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See <code><a href='ldest.html'>ldest</a>()</code> for details on the different types of LD
estimators supported.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<dl>
<dt><code><a href='ldest.html'>ldest</a>()</code></dt><dd><p>For the base function that estimates
pairwise LD.</p></dd>
<dt><code><a href='mldest.html'>mldest</a>()</code></dt><dd><p>For estimating pairwise LD between
<em>all</em> provided SNPs.</p></dd>
<dt><code><a href='ldfast.html'>ldfast</a>()</code></dt><dd><p>Fast, moment-based approach to LD estimation
that also accounts for genotype uncertainty.</p></dd>
<dt><code><a href='format_lddf.html'>format_lddf</a>()</code></dt><dd><p>For formatting the output of
<code>sldest()</code> as a matrix.</p></dd>
<dt><code><a href='plot.lddf.html'>plot.lddf</a>()</code></dt><dd><p>For plotting the output of
<code>sldest()</code>.</p></dd>

</dl>
</div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>David Gerard</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'>## Simulate genotypes when true correlation is 0</span>
<span class='va'>nloci</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>nind</span>  <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>win</span> <span class='op'>&lt;-</span> <span class='fl'>5</span>
<span class='va'>K</span> <span class='op'>&lt;-</span> <span class='fl'>6</span>
<span class='va'>nc</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>genomat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='va'>K</span>, <span class='va'>nind</span> <span class='op'>*</span> <span class='va'>nloci</span>, <span class='cn'>TRUE</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>nloci</span><span class='op'>)</span>

<span class='co'>## Composite LD estimates</span>
<span class='va'>lddf</span> <span class='op'>&lt;-</span> <span class='fu'>sldest</span><span class='op'>(</span>geno <span class='op'>=</span> <span class='va'>genomat</span>,
               K <span class='op'>=</span> <span class='va'>K</span>,
               win <span class='op'>=</span> <span class='va'>win</span>,
               nc <span class='op'>=</span> <span class='va'>nc</span>,
               type <span class='op'>=</span> <span class='st'>"comp"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lddf</span>, element <span class='op'>=</span> <span class='st'>"z"</span><span class='op'>)</span>
</div><div class='img'><img src='sldest-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Gerard.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


