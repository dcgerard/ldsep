<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pairwise LD estimation in polyploids. — ldest • ldsep</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Pairwise LD estimation in polyploids. — ldest"><meta property="og:description" content="Estimates either haplotypic or composite measures of LD using either
genotypes are genotype likelihoods via maximum likelihood.
The usual measures of LD are estimated (D, D', and r) along with
the Fisher-z transformation of r (called &quot;z&quot;). All estimates
are returned with standard errors. See Gerard (2021) for details."><meta property="og:image" content="https://dcgerard.github.io/ldsep/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ldsep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/fast.html">Fast LD Estimation</a>
    </li>
    <li>
      <a href="../articles/vcf.html">LD Estimation Pipeline from VCF</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dcgerard/ldsep/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pairwise LD estimation in polyploids.</h1>
    <small class="dont-index">Source: <a href="https://github.com/dcgerard/ldsep/blob/HEAD/R/ldgeno.R" class="external-link"><code>R/ldgeno.R</code></a></small>
    <div class="hidden name"><code>ldest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimates either haplotypic or composite measures of LD using either
genotypes are genotype likelihoods via maximum likelihood.
The usual measures of LD are estimated (D, D', and r) along with
the Fisher-z transformation of r (called "z"). All estimates
are returned with standard errors. See Gerard (2021) for details.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ldest</span><span class="op">(</span></span>
<span>  <span class="va">ga</span>,</span>
<span>  <span class="va">gb</span>,</span>
<span>  <span class="va">K</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hap"</span>, <span class="st">"comp"</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"flex"</span><span class="op">)</span>,</span>
<span>  pen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"hap"</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-ga">ga<a class="anchor" aria-label="anchor" href="#arg-ga"></a></dt>
<dd><p>One of two possible inputs:</p><ol><li><p>A vector of counts, containing the genotypes for each
individual at the first locus. When <code>type = "comp"</code>,
the vector of genotypes may be continuous (e.g. the
posterior mean genotype).</p></li>
<li><p>A matrix of genotype log-likelihoods at the first locus.
The rows index the individuals and the columns index
the genotypes. That is <code>ga[i, j]</code> is the genotype
likelihood of individual <code>i</code> for genotype <code>j-1</code>.</p></li>
</ol></dd>


<dt id="arg-gb">gb<a class="anchor" aria-label="anchor" href="#arg-gb"></a></dt>
<dd><p>One of two possible inputs:</p><ol><li><p>A vector of counts, containing the genotypes for each
individual at the second locus. When <code>type = "comp"</code>,
the vector of genotypes may be continuous (e.g. the
posterior mean genotype).</p></li>
<li><p>A matrix of genotype log-likelihoods at the second locus.
The rows index the individuals and the columns index
the genotypes. That is <code>gb[i, j]</code> is the genotype
likelihood of individual <code>i</code> for genotype <code>j-1</code>.</p></li>
</ol></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>The ploidy of the species. Assumed to be the same for all
individuals.</p></dd>


<dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>A logical. Should we calculate standard errors (<code>TRUE</code>) or
not (<code>FALSE</code>). Calculating standard errors can be really slow
when <code>type = "comp"</code>, <code>model = "flex"</code>, and when using
genotype likelihoods. Otherwise, standard error calculations
should be pretty fast.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The type of LD to calculate. The available types are
haplotypic LD (<code>type = "hap"</code>) or composite LD
(<code>type = "comp"</code>). Haplotypic LD is only appropriate for
autopolyploids when the individuals are in Hardy-Weinberg
equilibrium (HWE). The composite
measures of LD are always applicable, and consistently estimate the
usual measures of LD when HWE is fulfilled in autopolyploids.
However, when HWE is not fulfilled, interpreting the
composite measures of LD could be a little tricky.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>When <code>type = "comp"</code> and using genotype likelihoods,
should we use the proportional
bivariate normal model to estimate the genotype distribution
(<code>model = "norm"</code>), or the general categorical distribution
(<code>model = "flex"</code>)? Defaults to <code>"norm"</code>.</p></dd>


<dt id="arg-pen">pen<a class="anchor" aria-label="anchor" href="#arg-pen"></a></dt>
<dd><p>The penalty to be applied to the likelihood. You can think about
this as the prior sample size. Should be greater than 1. Does not
apply if <code>model = "norm"</code>, <code>type = "comp"</code>, and using
genotype likelihoods. Also does not apply when <code>type = "comp"</code>
and using genotypes.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A vector with some or all of the following elements:</p><dl><dt><code>D</code></dt>
<dd><p>The estimate of the LD coefficient.</p></dd>

<dt><code>D_se</code></dt>
<dd><p>The standard error of the estimate of
the LD coefficient.</p></dd>

<dt><code>r2</code></dt>
<dd><p>The estimate of the squared Pearson correlation.</p></dd>

<dt><code>r2_se</code></dt>
<dd><p>The standard error of the estimate of the
squared Pearson correlation.</p></dd>

<dt><code>r</code></dt>
<dd><p>The estimate of the Pearson correlation.</p></dd>

<dt><code>r_se</code></dt>
<dd><p>The standard error of the estimate of the
Pearson correlation.</p></dd>

<dt><code>Dprime</code></dt>
<dd><p>The estimate of the standardized LD
coefficient. When <code>type</code> = "comp", this corresponds
to the standardization where we fix allele frequencies.</p></dd>

<dt><code>Dprime_se</code></dt>
<dd><p>The standard error of <code>Dprime</code>.</p></dd>

<dt><code>Dprimeg</code></dt>
<dd><p>The estimate of the standardized LD
coefficient. This corresponds to the standardization where
we fix genotype frequencies.</p></dd>

<dt><code>Dprimeg_se</code></dt>
<dd><p>The standard error of <code>Dprimeg</code>.</p></dd>

<dt><code>z</code></dt>
<dd><p>The Fisher-z transformation of <code>r</code>.</p></dd>

<dt><code>z_se</code></dt>
<dd><p>The standard error of the Fisher-z
transformation of <code>r</code>.</p></dd>

<dt><code>p_ab</code></dt>
<dd><p>The estimated haplotype frequency of ab.
Only returned if estimating the haplotypic LD.</p></dd>

<dt><code>p_Ab</code></dt>
<dd><p>The estimated haplotype frequency of Ab.
Only returned if estimating the haplotypic LD.</p></dd>

<dt><code>p_aB</code></dt>
<dd><p>The estimated haplotype frequency of aB.
Only returned if estimating the haplotypic LD.</p></dd>

<dt><code>p_AB</code></dt>
<dd><p>The estimated haplotype frequency of AB.
Only returned if estimating the haplotypic LD.</p></dd>

<dt><code>q_ij</code></dt>
<dd><p>The estimated frequency of genotype i at locus 1
and genotype j at locus 2. Only returned if estimating the
composite LD.</p></dd>

<dt><code>n</code></dt>
<dd><p>The number of individuals used to estimate pairwise LD.</p></dd>


</dl></div>
    <div id="haplotypic-ld">
    <h2>Haplotypic LD</h2>



<p>This section describes the methods used when <code>type = "hap"</code> is
selected.</p>
<p>Haplotypic LD measures the association
between two loci on the same haplotype. When haplotypes are known, estimating
haplotypic LD is simple using just the haplotypic frequencies.</p>
<p>When haplotypes are not known, we can still estimate haplotypic frequencies
using the genotypes or genotype likelihoods
<em>in autopolyploids as long as Hardy-Weinberg equilibrium (HWE) is satisfied</em>. We do
this via maximum likelihood using gradient ascent. Gradient ascent is
performed over the unconstrained parameterization of the 3-simplex from
Betancourt (2012). The estimated haplotype frequencies are then used to
estimate haplotypic LD.</p>
<p>Standard errors are provided using standard maximum likelihood theory.
In brief, the Hessian matrix of the log-likelihood is calculated at
the MLE's of the haplotype frequencies. The negative inverse of this
Hessian matrix is approximately the covariance matrix of the MLE's of the
haplotype frequencies. Since all haplotypic LD measures are functions
of the haplotype frequencies, we use the delta-method to obtain
the standard errors for each LD estimate.</p>
<p>A Dirichlet(2,2,2,2) prior is placed over the frequencies of
haplotypes 00, 01, 10, and 11. This corresponds to the "add two" rule
of Agresti (1998). You can change this prior via the <code>pen</code> argument.</p>
<p>When you either do not have autopolyploids or when HWE is <em>not</em>
satisfied, then the estimates using <code>type = "hap"</code>
are nonsensical. However, the composite measures of LD are still
applicable (see below).</p>
    </div>
    <div id="composite-ld">
    <h2>Composite LD</h2>



<p>This section describes the methods used when <code>type = "comp"</code> is
selected.</p>
<p>When HWE is not satisfied, haplotype frequencies are not estimable. However,
measures of association between two loci are still estimable. These
associations may be caused by LD either on the same haplotype or between
different haplotypes. Cockerham and Weir (1977) thus called such measures
"composite" measures of LD.</p>
<p>When the genotypes are known, these composite measures have simple
correspondences to well-known statistical measures of association.
D is the covariance of genotypes between loci divided by the ploidy.
r is the Pearson correlation of genotypes. D' is D divided by a
term that involves only mean genotypes.</p>
<p>When genotypes are not known, we estimate the joint genotype frequencies
and use these to estimate the composite measures of LD using
genotype likelihoods. The distribution of genotypes is assumed to
either follow a proportional bivariate normal model (by default) or
a general categorical model.</p>
<p>These estimates of composite measures of LD estimate the haplotypic
measures of LD when HWE is fulfilled, but are still applicable when HWE
is not fulfilled.</p>
<p>When genotypes are known, standard errors are calculated using standard
moment-based approaches. When genotypes are not known, standard
errors are calculated using standard maximum likelihood theory,
same as for the haplotypic LD estimates (see above), or using
a bootstrap.</p>
    </div>
    <div id="references">
    <h2>References</h2>

<ul><li><p>Agresti, Alan, and Brent A. Coull. "Approximate is better than
"exact" for interval estimation of binomial proportions."
<em>The American Statistician</em> 52, no. 2 (1998): 119-126.
<a href="https://doi.org/10.1080/00031305.1998.10480550" class="external-link">doi:10.1080/00031305.1998.10480550</a></p></li>
<li><p>Betancourt, Michael. "Cruising the simplex: Hamiltonian Monte
Carlo and the Dirichlet distribution." In
<em>AIP Conference Proceedings 31st</em>, vol. 1443, no. 1,
pp. 157-164. American Institute of Physics, 2012.
<a href="https://doi.org/10.1063/1.3703631" class="external-link">doi:10.1063/1.3703631</a></p></li>
<li><p>Cockerham, C. Clark, and B. S. Weir. "Digenic descent measures
for finite populations." <em>Genetics Research</em> 30, no. 2 (1977):
121-147. <a href="https://doi.org/10.1017/S0016672300017547" class="external-link">doi:10.1017/S0016672300017547</a></p></li>
<li><p>Gerard, David. "Pairwise Linkage Disequilibrium Estimation
for Polyploids." <em>Molecular Ecology Resources</em> 21,
no. 4 (2021): 1230-1242. <a href="https://doi.org/10.1111/1755-0998.13349" class="external-link">doi:10.1111/1755-0998.13349</a></p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<dl><dt><code><a href="ldfast.html">ldfast</a>()</code></dt>
<dd><p>Fast, moment-based approach to LD estimation
that also accounts for genotype uncertainty.</p></dd>

<dt><code><a href="mldest.html">mldest</a>()</code></dt>
<dd><p>For calculating pairwise LD among all
pairs of a collection of SNPs.</p></dd>

<dt><code><a href="sldest.html">sldest</a>()</code></dt>
<dd><p>For calculating pairwise LD along a
sliding window of SNPs.</p></dd>

<dt><code><a href="ldest_hap.html">ldest_hap</a>()</code></dt>
<dd><p>For the function that directly estimates
haplotypic LD when HWE is fulfilled.</p></dd>

<dt><code><a href="ldest_comp.html">ldest_comp</a>()</code></dt>
<dd><p>For the function that directly
estimates composite LD.</p></dd>


</dl></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>David Gerard</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># sample size</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">6</span> <span class="co"># ploidy</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## generate some fake genotypes when LD = 0.</span></span></span>
<span class="r-in"><span><span class="va">ga</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, size <span class="op">=</span> <span class="va">K</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gb</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, size <span class="op">=</span> <span class="va">K</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ga</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 3 3 5 2 5</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 3 2 6 3 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## generate some fake genotype likelihoods when LD = 0.</span></span></span>
<span class="r-in"><span><span class="va">gamat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ga</span>, <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span>, x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">K</span>, sd <span class="op">=</span> <span class="fl">1</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gbmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gb</span>, <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span>, x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">K</span>, sd <span class="op">=</span> <span class="fl">1</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gamat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]       [,3]       [,4]      [,5]       [,6]      [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -2.918939 -1.418939 -0.9189385 -1.4189385 -2.918939 -5.4189385 -8.918939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -5.418939 -2.918939 -1.4189385 -0.9189385 -1.418939 -2.9189385 -5.418939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -5.418939 -2.918939 -1.4189385 -0.9189385 -1.418939 -2.9189385 -5.418939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -13.418939 -8.918939 -5.4189385 -2.9189385 -1.418939 -0.9189385 -1.418939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -2.918939 -1.418939 -0.9189385 -1.4189385 -2.918939 -5.4189385 -8.918939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] -13.418939 -8.918939 -5.4189385 -2.9189385 -1.418939 -0.9189385 -1.418939</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gbmat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3]       [,4]      [,5]      [,6]       [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -5.418939  -2.918939 -1.4189385 -0.9189385 -1.418939 -2.918939 -5.4189385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -5.418939  -2.918939 -1.4189385 -0.9189385 -1.418939 -2.918939 -5.4189385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -2.918939  -1.418939 -0.9189385 -1.4189385 -2.918939 -5.418939 -8.9189385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -18.918939 -13.418939 -8.9189385 -5.4189385 -2.918939 -1.418939 -0.9189385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -5.418939  -2.918939 -1.4189385 -0.9189385 -1.418939 -2.918939 -5.4189385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  -2.918939  -1.418939 -0.9189385 -1.4189385 -2.918939 -5.418939 -8.9189385</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Haplotypic LD with genotypes</span></span></span>
<span class="r-in"><span><span class="va">ldout1</span> <span class="op">&lt;-</span> <span class="fu">ldest</span><span class="op">(</span>ga <span class="op">=</span> <span class="va">ga</span>,</span></span>
<span class="r-in"><span>                gb <span class="op">=</span> <span class="va">gb</span>,</span></span>
<span class="r-in"><span>                K <span class="op">=</span> <span class="va">K</span>,</span></span>
<span class="r-in"><span>                type <span class="op">=</span> <span class="st">"hap"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ldout1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            D         D_se           r2        r2_se            r         r_se </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0058365062 0.0286113348 0.0005454794 0.0053480254 0.0233554997 0.1144917775 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Haplotypic LD with genotype likelihoods</span></span></span>
<span class="r-in"><span><span class="va">ldout2</span> <span class="op">&lt;-</span> <span class="fu">ldest</span><span class="op">(</span>ga <span class="op">=</span> <span class="va">gamat</span>,</span></span>
<span class="r-in"><span>                gb <span class="op">=</span> <span class="va">gbmat</span>,</span></span>
<span class="r-in"><span>                K <span class="op">=</span> <span class="va">K</span>,</span></span>
<span class="r-in"><span>                type <span class="op">=</span> <span class="st">"hap"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ldout2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           D        D_se          r2       r2_se           r        r_se </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.020950505 0.097754998 0.007028751 0.065592168 0.083837645 0.391185656 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Composite LD with genotypes</span></span></span>
<span class="r-in"><span><span class="va">ldout3</span> <span class="op">&lt;-</span> <span class="fu">ldest</span><span class="op">(</span>ga <span class="op">=</span> <span class="va">ga</span>,</span></span>
<span class="r-in"><span>                gb <span class="op">=</span> <span class="va">gb</span>,</span></span>
<span class="r-in"><span>                K <span class="op">=</span> <span class="va">K</span>,</span></span>
<span class="r-in"><span>                type <span class="op">=</span> <span class="st">"comp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ldout3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            D         D_se           r2        r2_se            r         r_se </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0044612795 0.0221319876 0.0004064944 0.0040307019 0.0201617053 0.0999593506 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Composite LD with genotype likelihoods and normal model</span></span></span>
<span class="r-in"><span><span class="va">ldout4</span> <span class="op">&lt;-</span> <span class="fu">ldest</span><span class="op">(</span>ga <span class="op">=</span> <span class="va">gamat</span>,</span></span>
<span class="r-in"><span>                gb <span class="op">=</span> <span class="va">gbmat</span>,</span></span>
<span class="r-in"><span>                K <span class="op">=</span> <span class="va">K</span>,</span></span>
<span class="r-in"><span>                type <span class="op">=</span> <span class="st">"comp"</span>,</span></span>
<span class="r-in"><span>                model <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ldout4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          D       D_se         r2      r2_se          r       r_se </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.02582342 0.01216744 0.67448607 0.26764449 0.82127101 0.16294530 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Composite LD with genotype likelihoods and general categorical model</span></span></span>
<span class="r-in"><span><span class="va">ldout5</span> <span class="op">&lt;-</span> <span class="fu">ldest</span><span class="op">(</span>ga <span class="op">=</span> <span class="va">gamat</span>,</span></span>
<span class="r-in"><span>                gb <span class="op">=</span> <span class="va">gbmat</span>,</span></span>
<span class="r-in"><span>                K <span class="op">=</span> <span class="va">K</span>,</span></span>
<span class="r-in"><span>                type <span class="op">=</span> <span class="st">"comp"</span>,</span></span>
<span class="r-in"><span>                model <span class="op">=</span> <span class="st">"flex"</span>,</span></span>
<span class="r-in"><span>                se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ldout5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           D        D_se          r2       r2_se           r        r_se </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.008882068          NA 0.018772196          NA 0.137011665          NA </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ldout1</span><span class="op">[[</span><span class="st">"D"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.005836506</span>
<span class="r-in"><span><span class="va">ldout2</span><span class="op">[[</span><span class="st">"D"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02095051</span>
<span class="r-in"><span><span class="va">ldout3</span><span class="op">[[</span><span class="st">"D"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.004461279</span>
<span class="r-in"><span><span class="va">ldout4</span><span class="op">[[</span><span class="st">"D"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02582342</span>
<span class="r-in"><span><span class="va">ldout5</span><span class="op">[[</span><span class="st">"D"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.008882068</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Gerard.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

